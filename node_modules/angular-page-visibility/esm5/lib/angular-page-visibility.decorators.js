import { Injector } from '@angular/core';
import { AngularPageVisibilityService } from './angular-page-visibility.service';
var providers = [
    { provide: AngularPageVisibilityService, deps: [] },
];
var injector = Injector.create({ providers: providers });
var pageVisibilityService = injector.get(AngularPageVisibilityService);
export function OnPageVisibilityChange() {
    return function (target, propertyKey, descriptor) {
        var originalMethod = descriptor.value;
        var onPageHiddenSubscription;
        if (!target.ngOnInit) {
            buildNewMethodNgOnInit(target);
        }
        var originalNgOnInit = target.ngOnInit;
        target.ngOnInit = function () {
            var _this = this;
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            onPageHiddenSubscription = pageVisibilityService.$onPageVisibilityChange.subscribe(function (visibilityState) {
                return originalMethod.call(_this, [visibilityState]);
            });
            if (originalNgOnInit) {
                originalNgOnInit.call(this, args);
            }
        };
        if (!target.ngOnDestroy) {
            buildNewMethodNgOnDestroy(target);
        }
        var originalNgOnDestroy = target.ngOnDestroy;
        target.ngOnDestroy = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            onPageHiddenSubscription.unsubscribe();
            if (originalNgOnDestroy) {
                originalNgOnDestroy.call(this, args);
            }
        };
    };
}
export function OnPageHidden() {
    return function (target, propertyKey, descriptor) {
        var originalMethod = descriptor.value;
        var onPageHiddenSubscription;
        if (!target.ngOnInit) {
            buildNewMethodNgOnInit(target);
        }
        var originalNgOnInit = target.ngOnInit;
        target.ngOnInit = function () {
            var _this = this;
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            onPageHiddenSubscription = pageVisibilityService.$onPageHidden.subscribe(function () { return originalMethod.call(_this); });
            if (originalNgOnInit) {
                originalNgOnInit.call(this, args);
            }
        };
        if (!target.ngOnDestroy) {
            buildNewMethodNgOnDestroy(target);
        }
        var originalNgOnDestroy = target.ngOnDestroy;
        target.ngOnDestroy = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            onPageHiddenSubscription.unsubscribe();
            if (originalNgOnDestroy) {
                originalNgOnDestroy.call(this, args);
            }
        };
    };
}
export function OnPageVisible() {
    return function (target, propertyKey, descriptor) {
        var originalMethod = descriptor.value;
        if (!target.ngOnInit) {
            buildNewMethodNgOnInit(target);
        }
        var originalNgOnInit = target.ngOnInit;
        var onPageVisibleSubscription;
        target.ngOnInit = function () {
            var _this = this;
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            onPageVisibleSubscription = pageVisibilityService.$onPageVisible.subscribe(function () { return originalMethod.call(_this); });
            if (originalNgOnInit) {
                originalNgOnInit.call(this, args);
            }
        };
        if (!target.ngOnDestroy) {
            buildNewMethodNgOnDestroy(target);
        }
        var originalNgOnDestroy = target.ngOnDestroy;
        target.ngOnDestroy = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            onPageVisibleSubscription.unsubscribe();
            if (originalNgOnDestroy) {
                originalNgOnDestroy.call(this, args);
            }
        };
    };
}
export function OnPagePrerender() {
    return function (target, propertyKey, descriptor) {
        var originalMethod = descriptor.value;
        var onPagePrerenderSubscription;
        if (!target.ngOnInit) {
            buildNewMethodNgOnInit(target);
        }
        var originalNgOnInit = target.ngOnInit;
        target.ngOnInit = function () {
            var _this = this;
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            onPagePrerenderSubscription = pageVisibilityService.$onPagePrerender.subscribe(function () { return originalMethod.call(_this); });
            if (originalNgOnInit) {
                originalNgOnInit.call(this, args);
            }
        };
        if (!target.ngOnDestroy) {
            buildNewMethodNgOnDestroy(target);
        }
        var originalNgOnDestroy = target.ngOnDestroy;
        target.ngOnDestroy = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            onPagePrerenderSubscription.unsubscribe();
            if (originalNgOnDestroy) {
                originalNgOnDestroy.call(this, args);
            }
        };
    };
}
export function OnPageUnloaded() {
    return function (target, propertyKey, descriptor) {
        var originalMethod = descriptor.value;
        var onPageUnloadedSubscription;
        if (!target.ngOnInit) {
            buildNewMethodNgOnInit(target);
        }
        var originalNgOnInit = target.ngOnInit;
        target.ngOnInit = function () {
            var _this = this;
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            onPageUnloadedSubscription = pageVisibilityService.$onPageUnloaded.subscribe(function () { return originalMethod.call(_this); });
            if (originalNgOnInit) {
                originalNgOnInit.call(this, args);
            }
        };
        if (!target.ngOnDestroy) {
            buildNewMethodNgOnDestroy(target);
        }
        var originalNgOnDestroy = target.ngOnDestroy;
        target.ngOnDestroy = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            onPageUnloadedSubscription.unsubscribe();
            if (originalNgOnDestroy) {
                originalNgOnDestroy.call(this, args);
            }
        };
    };
}
function buildNewMethodNgOnInit(target) {
    newMethod(target, 'ngOnInit');
}
function buildNewMethodNgOnDestroy(target) {
    newMethod(target, 'ngOnDestroy');
}
function newMethod(target, name) {
    Object.defineProperty(target, name, {
        value: function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
        },
        writable: true,
    });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYW5ndWxhci1wYWdlLXZpc2liaWxpdHkuZGVjb3JhdG9ycy5qcyIsInNvdXJjZVJvb3QiOiJuZzovL2FuZ3VsYXItcGFnZS12aXNpYmlsaXR5LyIsInNvdXJjZXMiOlsibGliL2FuZ3VsYXItcGFnZS12aXNpYmlsaXR5LmRlY29yYXRvcnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFFBQVEsRUFBa0IsTUFBTSxlQUFlLENBQUM7QUFDekQsT0FBTyxFQUFFLDRCQUE0QixFQUFFLE1BQU0sbUNBQW1DLENBQUM7QUFJakYsSUFBTSxTQUFTLEdBQXFCO0lBQ2xDLEVBQUUsT0FBTyxFQUFFLDRCQUE0QixFQUFFLElBQUksRUFBRSxFQUFFLEVBQUU7Q0FDcEQsQ0FBQztBQUNGLElBQU0sUUFBUSxHQUFHLFFBQVEsQ0FBQyxNQUFNLENBQUMsRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLENBQUMsQ0FBQztBQUMzRCxJQUFNLHFCQUFxQixHQUFHLFFBQVEsQ0FBQyxHQUFHLENBQUMsNEJBQTRCLENBQUMsQ0FBQztBQUV6RSxNQUFNLFVBQVUsc0JBQXNCO0lBQ3BDLE9BQU8sVUFDTCxNQUFXLEVBQ1gsV0FBbUIsRUFDbkIsVUFBOEI7UUFFOUIsSUFBTSxjQUFjLEdBQUcsVUFBVSxDQUFDLEtBQUssQ0FBQztRQUN4QyxJQUFJLHdCQUFzQyxDQUFDO1FBQzNDLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxFQUFFO1lBQ3BCLHNCQUFzQixDQUFDLE1BQU0sQ0FBQyxDQUFDO1NBQ2hDO1FBQ0QsSUFBTSxnQkFBZ0IsR0FBRyxNQUFNLENBQUMsUUFBUSxDQUFDO1FBQ3pDLE1BQU0sQ0FBQyxRQUFRLEdBQUc7WUFBQSxpQkFRakI7WUFSMEIsY0FBTztpQkFBUCxVQUFPLEVBQVAscUJBQU8sRUFBUCxJQUFPO2dCQUFQLHlCQUFPOztZQUNoQyx3QkFBd0IsR0FBRyxxQkFBcUIsQ0FBQyx1QkFBdUIsQ0FBQyxTQUFTLENBQ2hGLFVBQUMsZUFBK0M7Z0JB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QztBQUNMLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RvciwgU3RhdGljUHJvdmlkZXIgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEFuZ3VsYXJQYWdlVmlzaWJpbGl0eVNlcnZpY2UgfSBmcm9tICcuL2FuZ3VsYXItcGFnZS12aXNpYmlsaXR5LnNlcnZpY2UnO1xuaW1wb3J0IHsgQW5ndWxhclBhZ2VWaXNpYmlsaXR5U3RhdGVFbnVtIH0gZnJvbSAnLi9hbmd1bGFyLXBhZ2UtdmlzaWJpbGl0eS5zdGF0ZS5lbnVtJztcbmltcG9ydCB7IFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnO1xuXG5jb25zdCBwcm92aWRlcnM6IFN0YXRpY1Byb3ZpZGVyW10gPSBbXG4gIHsgcHJvdmlkZTogQW5ndWxhclBhZ2VWaXNpYmlsaXR5U2VydmljZSwgZGVwczogW10gfSxcbl07XG5jb25zdCBpbmplY3RvciA9IEluamVjdG9yLmNyZWF0ZSh7IHByb3ZpZGVyczogcHJvdmlkZXJzIH0pO1xuY29uc3QgcGFnZVZpc2liaWxpdHlTZXJ2aWNlID0gaW5qZWN0b3IuZ2V0KEFuZ3VsYXJQYWdlVmlzaWJpbGl0eVNlcnZpY2UpO1xuXG5leHBvcnQgZnVuY3Rpb24gT25QYWdlVmlzaWJpbGl0eUNoYW5nZSgpOiBNZXRob2REZWNvcmF0b3Ige1xuICByZXR1cm4gZnVuY3Rpb24oXG4gICAgdGFyZ2V0OiBhbnksXG4gICAgcHJvcGVydHlLZXk6IHN0cmluZyxcbiAgICBkZXNjcmlwdG9yOiBQcm9wZXJ0eURlc2NyaXB0b3IsXG4gICkge1xuICAgIGNvbnN0IG9yaWdpbmFsTWV0aG9kID0gZGVzY3JpcHRvci52YWx1ZTtcbiAgICBsZXQgb25QYWdlSGlkZGVuU3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb247XG4gICAgaWYgKCF0YXJnZXQubmdPbkluaXQpIHtcbiAgICAgIGJ1aWxkTmV3TWV0aG9kTmdPbkluaXQodGFyZ2V0KTtcbiAgICB9XG4gICAgY29uc3Qgb3JpZ2luYWxOZ09uSW5pdCA9IHRhcmdldC5uZ09uSW5pdDtcbiAgICB0YXJnZXQubmdPbkluaXQgPSBmdW5jdGlvbiguLi5hcmdzKSB7XG4gICAgICBvblBhZ2VIaWRkZW5TdWJzY3JpcHRpb24gPSBwYWdlVmlzaWJpbGl0eVNlcnZpY2UuJG9uUGFnZVZpc2liaWxpdHlDaGFuZ2Uuc3Vic2NyaWJlKFxuICAgICAgICAodmlzaWJpbGl0eVN0YXRlOiBBbmd1bGFyUGFnZVZpc2liaWxpdHlTdGF0ZUVudW0pID0+XG4gICAgICAgICAgb3JpZ2luYWxNZXRob2QuY2FsbCh0aGlzLCBbdmlzaWJpbGl0eVN0YXRlXSksXG4gICAgICApO1xuICAgICAgaWYgKG9yaWdpbmFsTmdPbkluaXQpIHtcbiAgICAgICAgb3JpZ2luYWxOZ09uSW5pdC5jYWxsKHRoaXMsIGFyZ3MpO1xuICAgICAgfVxuICAgIH07XG4gICAgaWYgKCF0YXJnZXQubmdPbkRlc3Ryb3kpIHtcbiAgICAgIGJ1aWxkTmV3TWV0aG9kTmdPbkRlc3Ryb3kodGFyZ2V0KTtcbiAgICB9XG4gICAgY29uc3Qgb3JpZ2luYWxOZ09uRGVzdHJveSA9IHRhcmdldC5uZ09uRGVzdHJveTtcbiAgICB0YXJnZXQubmdPbkRlc3Ryb3kgPSBmdW5jdGlvbiguLi5hcmdzKSB7XG4gICAgICBvblBhZ2VIaWRkZW5TdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgIGlmIChvcmlnaW5hbE5nT25EZXN0cm95KSB7XG4gICAgICAgIG9yaWdpbmFsTmdPbkRlc3Ryb3kuY2FsbCh0aGlzLCBhcmdzKTtcbiAgICAgIH1cbiAgICB9O1xuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gT25QYWdlSGlkZGVuKCk6IE1ldGhvZERlY29yYXRvciB7XG4gIHJldHVybiBmdW5jdGlvbihcbiAgICB0YXJnZXQ6IGFueSxcbiAgICBwcm9wZXJ0eUtleTogc3RyaW5nLFxuICAgIGRlc2NyaXB0b3I6IFByb3BlcnR5RGVzY3JpcHRvcixcbiAgKSB7XG4gICAgY29uc3Qgb3JpZ2luYWxNZXRob2QgPSBkZXNjcmlwdG9yLnZhbHVlO1xuICAgIGxldCBvblBhZ2VIaWRkZW5TdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcbiAgICBpZiAoIXRhcmdldC5uZ09uSW5pdCkge1xuICAgICAgYnVpbGROZXdNZXRob2ROZ09uSW5pdCh0YXJnZXQpO1xuICAgIH1cbiAgICBjb25zdCBvcmlnaW5hbE5nT25Jbml0ID0gdGFyZ2V0Lm5nT25Jbml0O1xuICAgIHRhcmdldC5uZ09uSW5pdCA9IGZ1bmN0aW9uKC4uLmFyZ3MpIHtcbiAgICAgIG9uUGFnZUhpZGRlblN1YnNjcmlwdGlvbiA9IHBhZ2VWaXNpYmlsaXR5U2VydmljZS4kb25QYWdlSGlkZGVuLnN1YnNjcmliZShcbiAgICAgICAgKCkgPT4gb3JpZ2luYWxNZXRob2QuY2FsbCh0aGlzKSxcbiAgICAgICk7XG4gICAgICBpZiAob3JpZ2luYWxOZ09uSW5pdCkge1xuICAgICAgICBvcmlnaW5hbE5nT25Jbml0LmNhbGwodGhpcywgYXJncyk7XG4gICAgICB9XG4gICAgfTtcbiAgICBpZiAoIXRhcmdldC5uZ09uRGVzdHJveSkge1xuICAgICAgYnVpbGROZXdNZXRob2ROZ09uRGVzdHJveSh0YXJnZXQpO1xuICAgIH1cbiAgICBjb25zdCBvcmlnaW5hbE5nT25EZXN0cm95ID0gdGFyZ2V0Lm5nT25EZXN0cm95O1xuICAgIHRhcmdldC5uZ09uRGVzdHJveSA9IGZ1bmN0aW9uKC4uLmFyZ3MpIHtcbiAgICAgIG9uUGFnZUhpZGRlblN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgaWYgKG9yaWdpbmFsTmdPbkRlc3Ryb3kpIHtcbiAgICAgICAgb3JpZ2luYWxOZ09uRGVzdHJveS5jYWxsKHRoaXMsIGFyZ3MpO1xuICAgICAgfVxuICAgIH07XG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBPblBhZ2VWaXNpYmxlKCk6IE1ldGhvZERlY29yYXRvciB7XG4gIHJldHVybiBmdW5jdGlvbihcbiAgICB0YXJnZXQ6IGFueSxcbiAgICBwcm9wZXJ0eUtleTogc3RyaW5nLFxuICAgIGRlc2NyaXB0b3I6IFByb3BlcnR5RGVzY3JpcHRvcixcbiAgKSB7XG4gICAgY29uc3Qgb3JpZ2luYWxNZXRob2QgPSBkZXNjcmlwdG9yLnZhbHVlO1xuICAgIGlmICghdGFyZ2V0Lm5nT25Jbml0KSB7XG4gICAgICBidWlsZE5ld01ldGhvZE5nT25Jbml0KHRhcmdldCk7XG4gICAgfVxuICAgIGNvbnN0IG9yaWdpbmFsTmdPbkluaXQgPSB0YXJnZXQubmdPbkluaXQ7XG4gICAgbGV0IG9uUGFnZVZpc2libGVTdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcbiAgICB0YXJnZXQubmdPbkluaXQgPSBmdW5jdGlvbiguLi5hcmdzKSB7XG4gICAgICBvblBhZ2VWaXNpYmxlU3Vic2NyaXB0aW9uID0gcGFnZVZpc2liaWxpdHlTZXJ2aWNlLiRvblBhZ2VWaXNpYmxlLnN1YnNjcmliZShcbiAgICAgICAgKCkgPT4gb3JpZ2luYWxNZXRob2QuY2FsbCh0aGlzKSxcbiAgICAgICk7XG4gICAgICBpZiAob3JpZ2luYWxOZ09uSW5pdCkge1xuICAgICAgICBvcmlnaW5hbE5nT25Jbml0LmNhbGwodGhpcywgYXJncyk7XG4gICAgICB9XG4gICAgfTtcbiAgICBpZiAoIXRhcmdldC5uZ09uRGVzdHJveSkge1xuICAgICAgYnVpbGROZXdNZXRob2ROZ09uRGVzdHJveSh0YXJnZXQpO1xuICAgIH1cbiAgICBjb25zdCBvcmlnaW5hbE5nT25EZXN0cm95ID0gdGFyZ2V0Lm5nT25EZXN0cm95O1xuICAgIHRhcmdldC5uZ09uRGVzdHJveSA9IGZ1bmN0aW9uKC4uLmFyZ3MpIHtcbiAgICAgIG9uUGFnZVZpc2libGVTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgIGlmIChvcmlnaW5hbE5nT25EZXN0cm95KSB7XG4gICAgICAgIG9yaWdpbmFsTmdPbkRlc3Ryb3kuY2FsbCh0aGlzLCBhcmdzKTtcbiAgICAgIH1cbiAgICB9O1xuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gT25QYWdlUHJlcmVuZGVyKCk6IE1ldGhvZERlY29yYXRvciB7XG4gIHJldHVybiBmdW5jdGlvbihcbiAgICB0YXJnZXQ6IGFueSxcbiAgICBwcm9wZXJ0eUtleTogc3RyaW5nLFxuICAgIGRlc2NyaXB0b3I6IFByb3BlcnR5RGVzY3JpcHRvcixcbiAgKSB7XG4gICAgY29uc3Qgb3JpZ2luYWxNZXRob2QgPSBkZXNjcmlwdG9yLnZhbHVlO1xuICAgIGxldCBvblBhZ2VQcmVyZW5kZXJTdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcbiAgICBpZiAoIXRhcmdldC5uZ09uSW5pdCkge1xuICAgICAgYnVpbGROZXdNZXRob2ROZ09uSW5pdCh0YXJnZXQpO1xuICAgIH1cbiAgICBjb25zdCBvcmlnaW5hbE5nT25Jbml0ID0gdGFyZ2V0Lm5nT25Jbml0O1xuICAgIHRhcmdldC5uZ09uSW5pdCA9IGZ1bmN0aW9uKC4uLmFyZ3MpIHtcbiAgICAgIG9uUGFnZVByZXJlbmRlclN1YnNjcmlwdGlvbiA9IHBhZ2VWaXNpYmlsaXR5U2VydmljZS4kb25QYWdlUHJlcmVuZGVyLnN1YnNjcmliZShcbiAgICAgICAgKCkgPT4gb3JpZ2luYWxNZXRob2QuY2FsbCh0aGlzKSxcbiAgICAgICk7XG4gICAgICBpZiAob3JpZ2luYWxOZ09uSW5pdCkge1xuICAgICAgICBvcmlnaW5hbE5nT25Jbml0LmNhbGwodGhpcywgYXJncyk7XG4gICAgICB9XG4gICAgfTtcbiAgICBpZiAoIXRhcmdldC5uZ09uRGVzdHJveSkge1xuICAgICAgYnVpbGROZXdNZXRob2ROZ09uRGVzdHJveSh0YXJnZXQpO1xuICAgIH1cbiAgICBjb25zdCBvcmlnaW5hbE5nT25EZXN0cm95ID0gdGFyZ2V0Lm5nT25EZXN0cm95O1xuICAgIHRhcmdldC5uZ09uRGVzdHJveSA9IGZ1bmN0aW9uKC4uLmFyZ3MpIHtcbiAgICAgIG9uUGFnZVByZXJlbmRlclN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgaWYgKG9yaWdpbmFsTmdPbkRlc3Ryb3kpIHtcbiAgICAgICAgb3JpZ2luYWxOZ09uRGVzdHJveS5jYWxsKHRoaXMsIGFyZ3MpO1xuICAgICAgfVxuICAgIH07XG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBPblBhZ2VVbmxvYWRlZCgpOiBNZXRob2REZWNvcmF0b3Ige1xuICByZXR1cm4gZnVuY3Rpb24oXG4gICAgdGFyZ2V0OiBhbnksXG4gICAgcHJvcGVydHlLZXk6IHN0cmluZyxcbiAgICBkZXNjcmlwdG9yOiBQcm9wZXJ0eURlc2NyaXB0b3IsXG4gICkge1xuICAgIGNvbnN0IG9yaWdpbmFsTWV0aG9kID0gZGVzY3JpcHRvci52YWx1ZTtcbiAgICBsZXQgb25QYWdlVW5sb2FkZWRTdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcbiAgICBpZiAoIXRhcmdldC5uZ09uSW5pdCkge1xuICAgICAgYnVpbGROZXdNZXRob2ROZ09uSW5pdCh0YXJnZXQpO1xuICAgIH1cbiAgICBjb25zdCBvcmlnaW5hbE5nT25Jbml0ID0gdGFyZ2V0Lm5nT25Jbml0O1xuICAgIHRhcmdldC5uZ09uSW5pdCA9IGZ1bmN0aW9uKC4uLmFyZ3MpIHtcbiAgICAgIG9uUGFnZVVubG9hZGVkU3Vic2NyaXB0aW9uID0gcGFnZVZpc2liaWxpdHlTZXJ2aWNlLiRvblBhZ2VVbmxvYWRlZC5zdWJzY3JpYmUoXG4gICAgICAgICgpID0+IG9yaWdpbmFsTWV0aG9kLmNhbGwodGhpcyksXG4gICAgICApO1xuICAgICAgaWYgKG9yaWdpbmFsTmdPbkluaXQpIHtcbiAgICAgICAgb3JpZ2luYWxOZ09uSW5pdC5jYWxsKHRoaXMsIGFyZ3MpO1xuICAgICAgfVxuICAgIH07XG4gICAgaWYgKCF0YXJnZXQubmdPbkRlc3Ryb3kpIHtcbiAgICAgIGJ1aWxkTmV3TWV0aG9kTmdPbkRlc3Ryb3kodGFyZ2V0KTtcbiAgICB9XG4gICAgY29uc3Qgb3JpZ2luYWxOZ09uRGVzdHJveSA9IHRhcmdldC5uZ09uRGVzdHJveTtcbiAgICB0YXJnZXQubmdPbkRlc3Ryb3kgPSBmdW5jdGlvbiguLi5hcmdzKSB7XG4gICAgICBvblBhZ2VVbmxvYWRlZFN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgaWYgKG9yaWdpbmFsTmdPbkRlc3Ryb3kpIHtcbiAgICAgICAgb3JpZ2luYWxOZ09uRGVzdHJveS5jYWxsKHRoaXMsIGFyZ3MpO1xuICAgICAgfVxuICAgIH07XG4gIH07XG59XG5cbmZ1bmN0aW9uIGJ1aWxkTmV3TWV0aG9kTmdPbkluaXQodGFyZ2V0OiBhbnkpIHtcbiAgbmV3TWV0aG9kKHRhcmdldCwgJ25nT25Jbml0Jyk7XG59XG5cbmZ1bmN0aW9uIGJ1aWxkTmV3TWV0aG9kTmdPbkRlc3Ryb3kodGFyZ2V0OiBhbnkpIHtcbiAgbmV3TWV0aG9kKHRhcmdldCwgJ25nT25EZXN0cm95Jyk7XG59XG5cbmZ1bmN0aW9uIG5ld01ldGhvZCh0YXJnZXQ6IGFueSwgbmFtZTogc3RyaW5nKSB7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIG5hbWUsIHtcbiAgICB2YWx1ZTogZnVuY3Rpb24oLi4uYXJncykge30sXG4gICAgd3JpdGFibGU6IHRydWUsXG4gIH0pO1xufVxuIl19